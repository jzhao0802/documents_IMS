

/*libname FFDir 'P:\Pricing Studies\Macros';*/


/* prodnotes, formstatus are 2 mapping files for formulary focus data */

/*
data FFDir.prodnotes;
	input Code Notes $46. Prod_Notes_Code $ Prod_Notes_Description $60.;
	datalines;
101	QUANTITY LIMIT MAY APPLY						003	LIMIT PRESCRIPTION TO SPECIFIED DAYS/QUANTITY
101	QUANTITY LIMIT MAY APPLY						161	PRIOR AUTHORIZATION REQ. WHEN QUANTITY LIMIT IS EXCEEDED
101	QUANTITY LIMIT MAY APPLY						178	QUANTITY LIMIT DEPENDENT UPON PLAN
101	QUANTITY LIMIT MAY APPLY						230	QUANTITY LIMIT DEPENDENT UPON DIAGNOSIS
101	QUANTITY LIMIT MAY APPLY						261	LIMIT RX TO SPECIFIED QUANTITY EXCEPT FOR HIGHEST STRENGTH
101	QUANTITY LIMIT MAY APPLY						278	QUANTITY LIMITS APPLY UNLESS PRESCRIBED BY SPECIALIST
101	QUANTITY LIMIT MAY APPLY						273	QUANTITY DISPENSING INSTRUCTIONS MAY APPLY
101	QUANTITY LIMIT MAY APPLY						088	MAY BE SUBJECT TO UTILIZATION CONTROL
101	QUANTITY LIMIT MAY APPLY						205	NO REFILL
101	QUANTITY LIMIT MAY APPLY						168	LIMITED TO 1 PER RX
101	QUANTITY LIMIT MAY APPLY						343	ADDITIONAL COPAY MAY APPLY DEPENDING ON QUANTITY LIMIT
101	QUANTITY LIMIT MAY APPLY						301	PRIOR AUTHORIZATION REQUIRED AFTER 1ST FILL
102	PRIOR AUTHORIZATION MAY BE REQUIRED				048	PRIOR AUTHORIZATION REQUIRED
102	PRIOR AUTHORIZATION MAY BE REQUIRED				070	MAY REQUIRE PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				098	PRIOR AUTHORIZATION REQUIRED FOR NEW RX'S
102	PRIOR AUTHORIZATION MAY BE REQUIRED				154	NON-FORMULARY-REQUIRES PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				158	HIGHER CO-PAY AND/OR PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				176	MAY BE COVERED WITH PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				270	COVERED FOR 3 MONTHS WITH PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				338	NON-FORMULARY OR REQUIRES PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				217	PAID AS PREFERRED WITH PRIOR AUTHORIZATION
102	PRIOR AUTHORIZATION MAY BE REQUIRED				254	PRIOR AUTHORIZATION REQUIRED FOR REDUCED COPAY
102	PRIOR AUTHORIZATION MAY BE REQUIRED				171	PRIOR AUTHORIZATION REQ. FOR SPECIFIC INDICATIONS
103	STEP THERAPY REQUIREMENT						037	USE ONLY IF BENZODIAZEPINES CANNOT BE USED
103	STEP THERAPY REQUIREMENT						039	ONLY IF OTHER THERAPY HAS FAILED
103	STEP THERAPY REQUIREMENT						131	STEP THERAPY
103	STEP THERAPY REQUIREMENT						159	STEP THERAPY- FIRST LEVEL
103	STEP THERAPY REQUIREMENT						160	STEP THERAPY- 2ND LEVEL
103	STEP THERAPY REQUIREMENT						268	REQUIRES TRIAL OF OTHER THERAPY
103	STEP THERAPY REQUIREMENT						227	REQUIRES PRIOR USAGE OF OTHER PRODUCT IN THERAPEUTIC CLASS
103	STEP THERAPY REQUIREMENT						228	RESTRICTED TO PATIENTS WHO FAIL TO REACH TARGET LDL
103	STEP THERAPY REQUIREMENT						257	MUST MEET HISTORY CRITERIA REQUIREMENTS
104	PRESCRIPTION BY SPECIALISTS ONLY				026	PRESCRIPTION BY PSYCHIATRIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				027	PRESCRIPTION BY NEUROLOGIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				040	RX BY HEMATOLOGISTS/ONCOLOGISTS ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				044	PRESCRIPTION BY OPHTHALMOLOGIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				082	PRESCRIPTION BY ENDOCRINOLOGIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				107	PRESCRIPTION BY UROLOGIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				113	USE LIMITED TO SPECIALISTS
104	PRESCRIPTION BY SPECIALISTS ONLY				117	PRESCRIPTION BY GERONOTOLOGIST
104	PRESCRIPTION BY SPECIALISTS ONLY				201	PRESCRIPTION BY RHEUMATOLOGIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				204	PRESCRIPTION BY SPECIALIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				225	PRESCRIPTION BY GASTROENERTOLOGIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				258	COVERED WHEN PRESCRIBED BY A CARDIOLOGIST
104	PRESCRIPTION BY SPECIALISTS ONLY				255	COVERED FOR PATIENTS CARED FOR BY A PSYCHIATRIST
104	PRESCRIPTION BY SPECIALISTS ONLY				269	PRESCRIPTION BY DENTIST ONLY
104	PRESCRIPTION BY SPECIALISTS ONLY				238	PRESCRIPTION BY SPECIALIST OR PRIOR AUTH REQUIRED
105	SPECIALIST CONSULTATION SUGGESTED/RECOMMENDED	001	CARDIOLOGIST CONSULT SUGGESTED/RECOMMENDED
105	SPECIALIST CONSULTATION SUGGESTED/RECOMMENDED	002	DERMATOLOGIST CONSULTATION SUGGESTED/RECOMMENDED
105	SPECIALIST CONSULTATION SUGGESTED/RECOMMENDED	102	PSYCHIATRIST CONSULTATION SUGGESTED
105	SPECIALIST CONSULTATION SUGGESTED/RECOMMENDED	110	NEUROLOGY CONSULT RECOMMENDED
105	SPECIALIST CONSULTATION SUGGESTED/RECOMMENDED	197	CONSULTATION RECOMMENDED
105	SPECIALIST CONSULTATION SUGGESTED/RECOMMENDED	220	UROLOGY CONSULT REQUIRED
106	FIRST LINE AGENT								079	 FIRST LINE AGENT
107	SECOND LINE AGENT								014	RESERVE AS 2nd LINE THERAPY 
107	SECOND LINE AGENT								019	2ND LINE CHILD, 3RD LINE ADULT
107	SECOND LINE AGENT								080	 SECOND LINE AGENT
107	SECOND LINE AGENT								095	2ND LIND CHILD & 2ND LINE ADULT
107	SECOND LINE AGENT								231	NOT CONSIDERED FIRST LINE THERAPY
107	SECOND LINE AGENT								219	NOT COVERED AS FIRST LINE AGENT
108	THIRD LINE AGENT								033	RESERVE AS THIRD LINE THERAPY
108	THIRD LINE AGENT								212	THIRD LINE AGENT
109	COMBINATION THERAPY								215	CONCOMITANT THERAPY
109	COMBINATION THERAPY								236	USE IN COMBINATION WITH OTHER THERAPY
109	COMBINATION THERAPY								240	CONCURRENT THERAPY
109	COMBINATION THERAPY								089	ADJUNCTIVE THERAPY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			010	USE RESTRICTED TO SPECIFIC DIAGNOSIS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			012	RESTRICTED TO IMMUNOCOMPROMISED PATIENTS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			013	COSMETIC USE NOT COVERED
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			011	PROPHYLACTIC RX TO PREVENT BONE LOSS IN  WOMEN
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			017	3GM TUBE INITIAL OUTBREAKS ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			018	FOR ANGINA ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			023	PRIMARY PREVENTION ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			024	NON-SMOKERS UNDER 45 YEARS OF AGE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			025	SMOKERS OR THOSE OVER 45 YEARS OF AGE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			028	TOPICAL USE NOT COVERED
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			032	LIMITED TO ACNE ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			041	FOR CHEMOTHERAPY-INDUCED VOMITING ONLY 
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			042	TERMINAL PAIN ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			049	RESTRICTED TO PREGNANT FEMALES
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			052	EYE OR HAND IMPAIRED
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			054	RESTRICT TO KIDNEY FAILURE OR DIALYSIS PTS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			059	USE FOR CHRONIC INSOMNIA
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			060	USE FOR ACUTE INSOMNIA
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			075	RESTRICTED FOR ORGAN TRANSPLANT USE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			078	DIAGNOSIS REQUIRED
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			081	ACUTE USE ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			092	RESERVE FOR PATIENTS IN WHOM BENEFITS OUTWEIGH RISKS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			099	FOR CHRONIC USE ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			045	RESTRICTED TO OB/GYN USE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			046	RESTRICTED TO DERMATOLOGY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			047	RESTRICTED TO CARDIOLOGY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			100	RESTRICTED TO G.I.
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			101	RESTRICTED TO INTERNAL MEDICINE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			105	RESTRICTED TO INFECTIOUS DISEASE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			130	APPROVED FOR BREASTFEEDING WOMEN ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			175	PRIOR AUTHORIZATION REQUIRED, EXCEPT UNDER SPECIFIED USE
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			218	RESTRICTED TO PREGNANT/NURSING WOMEN
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			282	NOT COVERED FOR HAIR LOSS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			297	RENAL PATIENTS ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			333	NOT COVERED FOR NAIL FUNGUS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			521	FOR CANCER RELATED PAIN ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			118	FOR PATIENTS UNABLE TO TAKE ORAL MEDS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			119	NOT COVERED WHEN USED AS AN ANOREXIANT
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			069	REQ ENROLLMENT IN SMOKING CESSATION PROGRAM
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			076	RESTRICTED TO REFILLS ONLY
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			086	CBC MUST BE PERFORMED
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			090	REQ ENROLLMENT IN APRROVED TREATMENT PLAN
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			091	RESTRICTED COVERAGE FOR HOSPICE PATIENTS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			127	FOR LONG TERM CARE PATIENTS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			209	COVERAGE DETERMINED UPON DIAGNOSIS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			214	NOT COVERED FOR SMOKING CESSATION
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			263	MAY BE TIER 2 FOR SELECT PRESCRIBERS/DIAGNOSES
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			262	MUST MEET CRITERIA REQUIREMENTS
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			271	USE RESTRICTED TO SPECIFIC GUIDELINES
110	USE RESTRICTED TO SPECIFIC DIAGNOSIS			116	FIRST LINE USE FOR ANIMAL/HUMAN BITES
111	GENERIC SUBSTITUTION MAY BE REQUIRED			120	GENERIC SUBSTITUTION REQUIRED
111	GENERIC SUBSTITUTION MAY BE REQUIRED			137	GENERIC SUBSTITUTION MAY BE REQUIRED
111	GENERIC SUBSTITUTION MAY BE REQUIRED			163	COVERED IN GENERIC FORM ONLY
111	GENERIC SUBSTITUTION MAY BE REQUIRED			180	PATIENT IS RESPONSIBLE FOR COST BETWEEN GENERIC AND BRAND
111	GENERIC SUBSTITUTION MAY BE REQUIRED			309	GENERICS SHOULD BE FIRST LINE OF PRESCRIBING
111	GENERIC SUBSTITUTION MAY BE REQUIRED			321	SUBSTITUTION MAY BE REQUIRED
112	DOSAGE RESTRICTIONS MAY APPLY					036	DAILY DOSE RESTRICTED BY BODY WEIGHT 
112	DOSAGE RESTRICTIONS MAY APPLY					055	15 GRAM TUBE ONLY IS COVERED
112	DOSAGE RESTRICTIONS MAY APPLY					093	PRIOR AUTHORIZATION REQUIRED FOR DOSES >150MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					097	DOSAGE  FORM RESTRICTION
112	DOSAGE RESTRICTIONS MAY APPLY					103	PRIOR AUTH REQ FOR DOSES > 40MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					104	PRIOR AUTH REQ FOR DOSES > 300MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					188	SPECIAL DOSING RESTRICTIONS APPLY
112	DOSAGE RESTRICTIONS MAY APPLY					192	DOSAGE RESTRICTION
112	DOSAGE RESTRICTIONS MAY APPLY					241	PRIOR AUTHORIZATION REQUIRED FOR DOSES > 20MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					242	PRIOR AUTHORIZATION REQUIRED FOR DOSES > 60MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					243	PRIOR AUTHORIZATION REQUIRED FOR DOSES >400MG DAY
112	DOSAGE RESTRICTIONS MAY APPLY					244	PRIOR AUTHORIZATION REQUIRED FOR DOSES > 45MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					245	PRIOR AUTHORIZATION REQUIRED FOR DOSES> 500MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					246	PRIOR AUTHORIZATION REQUIRED FOR DOSES >30MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					247	PRIOR AUTHORIZATION REQUIRED FOR DOSES> 900MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					248	PRIOR AUTHORIZATION REQUIRED FOR DOSES> 800 MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					249	PRIOR AUTHORIZATION REQUIRED FOR DOSES> 6MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					250	PRIOR AUTHORIZATION REQUIRED FOR DOSES> 160MG/DAY
112	DOSAGE RESTRICTIONS MAY APPLY					124	DOSAGE PACK REQUIRED
112	DOSAGE RESTRICTIONS MAY APPLY					251	LOWER DOSE RECOMMENDED FOR 65 AND OLDER
112	DOSAGE RESTRICTIONS MAY APPLY					334	DOSE OPTIMIZATION
113	MAY BE RESTRICTED BY GENDER						035	NOT COVERED FOR FEMALES
113	MAY BE RESTRICTED BY GENDER						065	FOR FEMALES ONLY
113	MAY BE RESTRICTED BY GENDER						096	MALES NOT COVERED
113	MAY BE RESTRICTED BY GENDER						129	FOR MALES ONLY
113	MAY BE RESTRICTED BY GENDER						206	RESTRICTED FOR MALES
113	MAY BE RESTRICTED BY GENDER						210	RESTRICTED FOR FEMALES
113	MAY BE RESTRICTED BY GENDER						346	COVERED FOR FEMALES
113	MAY BE RESTRICTED BY GENDER						348	GENDER EDIT IS APPLICABLE 
113	MAY BE RESTRICTED BY GENDER						385	COVERED FOR MALES
114	MAY BE RESTRICTED BY AGE						016	RECOMMENDED FOR AGE 12 AND UNDER
114	MAY BE RESTRICTED BY AGE						029	PRIOR AUTH NEEDED FOR THOSE 35 AND ABOVE
114	MAY BE RESTRICTED BY AGE						038	PRIOR AUTHORIZATION FOR THOSE UNDER 35
114	MAY BE RESTRICTED BY AGE						043	RESTRICTED BY PATIENT AGE
114	MAY BE RESTRICTED BY AGE						050	PRIOR AUTH. NEEDED FOR AGE 7 YEARS AND OVER
114	MAY BE RESTRICTED BY AGE						066	SENIOR CITIZEN RESTRICTION
114	MAY BE RESTRICTED BY AGE						157	PRIOR AUTHORIZATION FOR PATIENTS OVER 40 YEARS OLD
114	MAY BE RESTRICTED BY AGE						162	PRIOR AUTHORIZATION REQ IF OVER 17 YEARS OLD
114	MAY BE RESTRICTED BY AGE						167	PRIOR AUTHORIZATION IF OVER 18 YEARS OF AGE
114	MAY BE RESTRICTED BY AGE						169	PRIOR AUTHORIZATION REQ IF AGE LIMIT EXCEEDED
114	MAY BE RESTRICTED BY AGE						233	COVERED FOR MEMBERS UNDER AGE 18
114	MAY BE RESTRICTED BY AGE						317	COVERED FOR CHILDREN 12 YEARS AND YOUNGER
114	MAY BE RESTRICTED BY AGE						322	PRIOR AUTHORIZATION REQUIRED FOR MEMBERS UNDER AGE 50
114	MAY BE RESTRICTED BY AGE						323	PRIOR AUTHORIZATION REQUIRED FOR MEMBERS UNDER 18
114	MAY BE RESTRICTED BY AGE						340	PRIOR AUTH REQUIRED IF UNDER 75 YEARS OF AGE
114	MAY BE RESTRICTED BY AGE						022	PEDIATRIC USE ONLY
115	WARNINGS										004	ORAL CONTRACEP W/ESTRO NOT EFFECTIVE WITH DRUG
115	WARNINGS										005	DO NOT ADMINISTER TO PREGNANT/NURSING WOMEN
115	WARNINGS										006	ADMIN OFCOMB NSAIDS/ACE INH MAY HAVE SIDE EFFCTS
115	WARNINGS										009	DO NOT ADMINISTER TO CHILDREN 
115	WARNINGS										034	NOT RECOMMENDED FOR ELDERLY
115	WARNINGS										056	IMPLANTATION ONLY BY TRAINED PROVIDER
115	WARNINGS										061	ABSTAIN FROM ALCOHOL
115	WARNINGS										191	CAUTION WITH USE IN ELDERLY
115	WARNINGS										193	MAY NOT BE RECOMMENDED FOR CHILDREN OR PREGNANT WOMEN
115	WARNINGS										198	USE BY PREGNANT WOMEN IS ASSOCIATED WITH INCREASED RISKS
115	WARNINGS										203	CAUTION WITH USE IN PATIENTS WITH IMPAIRED RENAL FUNCTION
115	WARNINGS										264	INCREASED RISK ASSOCIATED WITH PEOPLE 65 AND OLDER
115	WARNINGS										284	CAUTION WITH USE IN PEDIATRIC POPULATION
115	WARNINGS										306	PRIOR AUTH REQUIRED FOR PREGNANT WOMEN
115	WARNINGS										068	THIS TABLET MAY NOT BE SPLIT
115	WARNINGS										083	SENIORS REDUCED DOSE MAY BE NEEDED
116	MEDICAL EXCEPTION REQUIRED						200	COVERED ONLY IF MEDICAL EXCEPTION IS OBTAINED
116	MEDICAL EXCEPTION REQUIRED						289	MEDICAL EXCEPTION REQUIRED
117	PREFERRED BRAND									072	PREFERRED BRAND WITHIN CLASS
117	PREFERRED BRAND									146	PREFERRED BRAND WITHIN TIER
117	PREFERRED BRAND									150	PREFERRED DUAL-BRANDED PRODUCT
117	PREFERRED BRAND									156	FORMULARY PREFERRED DRUG
117	PREFERRED BRAND									177	PREFERRED BRAND
118	NON-PREFERRED PRODUCT							111	NON-FORMULARY BUT COVERED
118	NON-PREFERRED PRODUCT							122	NON-FORMULARY PRODUCT, COVERAGE NOT INDICATED
118	NON-PREFERRED PRODUCT							123	NON-PREFERRED ITEM, MAY RESULT IN HIGHER COPAY
118	NON-PREFERRED PRODUCT							134	NON-FORMULARY-HIGHER COPAY
118	NON-PREFERRED PRODUCT							136	NON-PREFERRED-COVERAGE NOT INDICATED
118	NON-PREFERRED PRODUCT							142	NON-PREFERRED PRODUCT- HIGHER CO-PAY
118	NON-PREFERRED PRODUCT							015	NON-FORMULARY BUT COVERED WITH HIGHER CO-PAY
118	NON-PREFERRED PRODUCT							145	NON-PREFERRED PRODUCT- HIGHER C0-PAY OR TOTAL COST
118	NON-PREFERRED PRODUCT							149	NON-FORMULARY-HIGHER CO-PAY OR TOTAL COST
118	NON-PREFERRED PRODUCT							208	NON-PREFERRED PRODUCT
118	NON-PREFERRED PRODUCT							213	NON-FORMULARY, MAY RESULT IN HIGHER COPAY
118	NON-PREFERRED PRODUCT							155	GENERIC IS CONSIDERED NON-PREFERRED
119	NOT COVERED PRODUCT								166	NON-FORMULARY-NOT REIMBURSED
119	NOT COVERED PRODUCT								232	NOT COVERED UNDER PHARMACY BENEFIT
120	GENERIC COPAY									170	FORMULARY GENERIC HAS GENERIC CO-PAY
120	GENERIC COPAY									173	GENERIC CO-PAY APPLIES FOR BRAND
120	GENERIC COPAY									174	GENERIC CO-PAY APPLIES FOR BRAND
121	BRAND COPAY										290	BRAND CO PAY 
121	BRAND COPAY										164	FORMULARY BRAND-HAS BRAND CO-PAYMENT
121	BRAND COPAY										223	BRAND COPAY APPLIES TO GENERIC
122	HIGHER COPAY									030	IF ALLOWED WITH HIGHER CO-PAY
122	HIGHER COPAY									144	OTC-HIGHER CO-PAY REQUIRED
122	HIGHER COPAY									194	SELECTED PRODUCT HAS HIGHER CO-PAY
122	HIGHER COPAY									256	HIGHER CO-PAY MAY APPLY
122	HIGHER COPAY									274	HIGHER CO-PAY FOR NEW AND RENEWING PRESCRIPTIONS
122	HIGHER COPAY									276	MEMBER WILL PAY NON-FORMULARY 50% COPAY
122	HIGHER COPAY									307	100% COPAY APPLIES
123	REDUCED COPAY									187	NO COPAY APPLIES TO PRODUCT
123	REDUCED COPAY									253	PRODUCT HAS REDUCED CO-PAY AMOUNT
123	REDUCED COPAY									202	AVAILABLE AT DISCOUNTED PRICE
123	REDUCED COPAY									266	PRODUCT MAY HAVE REDUCED COPAY AMOUNT
124	COINSURANCE										308	20% COINSURANCE
124	COINSURANCE										311	50% COINSURANCE
124	COINSURANCE										326	PERCENTAGE CO-PAY APPLIES
124	COINSURANCE										328	25% COINSURANCE
125	MISCELLANEOUS RESTRICTIONS						020	NO NEW PATIENTS
125	MISCELLANEOUS RESTRICTIONS						021	NOT FOR MAINTENANCE DOSING
125	MISCELLANEOUS RESTRICTIONS						087	SPECIAL ORDER FORM REQUIRED
125	MISCELLANEOUS RESTRICTIONS						132	PRODUCT HAS NON-SPECIFIC MULTIPLE RESTRICTIONS
125	MISCELLANEOUS RESTRICTIONS						114	BRAND IS RESTRICTED DUE TO HIGHER COSTS
125	MISCELLANEOUS RESTRICTIONS						267	RESTRICTED FOR NEW PATIENTS
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				121	COVERAGE DETERMINED BY INDIVIDUAL PLAN
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				184	PLAN LIMITATIONS MAY APPLY
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				189	LIMITATIONS BY EMPLOYER MAY APPLY
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				195	CONTINUED THERAPY WITH PLAN LIMITATIONS
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				211	RESTRICTION DETERMINED BY INDIVIDUAL PLAN
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				224	MUST CONFORM TO EXISTING POLICY
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				279	COVERAGE DETERMINED BY EMPLOYER
126	PLAN/EMPLOYER LIMITATIONS MAY APPLY				051	AVAIL CONTINGENT ON IND PLAN APPROVAL/FORMULARY
127	SPECIAL MEDICAL BENEFIT MAY APPLY				115	MEDICAL BENEFIT ONLY
127	SPECIAL MEDICAL BENEFIT MAY APPLY				172	RESTRICTED TO MEDICAL  BENEFIT
127	SPECIAL MEDICAL BENEFIT MAY APPLY				390	DIABETIC BENEFIT
127	SPECIAL MEDICAL BENEFIT MAY APPLY				295	INJECTABLE BENEFIT
127	SPECIAL MEDICAL BENEFIT MAY APPLY				185	COVERED UNDER BEHAVIORAL HEALTH BENEFIT
127	SPECIAL MEDICAL BENEFIT MAY APPLY				275	FOR RETIREES, COVERAGE IS THROUGH MEDICAL BENEFIT
127	SPECIAL MEDICAL BENEFIT MAY APPLY				288	MAY BE COVERED UNDER THE MEDICAL BENEFIT
128	SPECIAL PROGRAM MAY APPLY						259	MAY BE PROVIDED BY MANUFACTURER AT NO CHARGE 
128	SPECIAL PROGRAM MAY APPLY						281	CONTACT PROGRAM DIRECTLY FOR PRODUCT AVAILABILITY
128	SPECIAL PROGRAM MAY APPLY						305	EXCLUDED FROM FIRST FILL PROGRAM
128	SPECIAL PROGRAM MAY APPLY						315	INCLUDED IN POINT OF SALE PROGRAM MAY REQUIRE EXCEPTION
128	SPECIAL PROGRAM MAY APPLY						347	PART OF QUALITY CARE DOSING PROGRAM
128	SPECIAL PROGRAM MAY APPLY						360	PART OF GENERIC COPAY WAIVER PROGRAM
128	SPECIAL PROGRAM MAY APPLY						316	GENERIC SAMPLING PROGRAM
128	SPECIAL PROGRAM MAY APPLY						314	PRODUCT HAS ADDITIONAL REBATES
128	SPECIAL PROGRAM MAY APPLY						335	AVAILABLE BY THE MANUFACTURER TO THOSE ON EXISTING THERAPY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			058	FILL AT CORPORATE PHARMACY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			125	FILL THROUGH MAIL ORDER PHARMACY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			196	FILL THROUGH SPECIALTY PHARMACY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			229	FILL AT DESIGNATED PHARMACY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			265	FILL THROUGH SPECIALTY PROGRAM
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			179	MAIL ORDER BENEFIT 
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			280	COVERED AT RETAIL ONLY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			285	OBTAIN FROM PARTICIPATING PHARMACY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			310	NO MAIL ORDER
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			237	HOSPICE PATIENTS ONLY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			283	MAY NEED TO BE ORDERED
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			327	MAY NEED TO OBTAIN FROM SPECIALTY PHARMACY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			330	PROVIDED THROUGH PREFERRED INJECTABLE PHARMACY ONLY
129	SPECIFIC PHARMACY INSTRUCTION MAY APPLY			351	PHARMACY EDIT NOTIFICATION
130	MAINTENANCE MEDICATION							071	FOR  MAINTENANCE ONLY
130	MAINTENANCE MEDICATION							128	MAINTENANCE MEDICATION BENEFIT APPLICABLE
130	MAINTENANCE MEDICATION							148	MAINTENANCE MEDICATION
131	PILL SPLITTING INSTRUCTION						294	MAY BE SPLIT
131	PILL SPLITTING INSTRUCTION						296	PILL IS SCORED
131	PILL SPLITTING INSTRUCTION						143	USE 1/2 TABLET FOR OTHER STRENGTHS
131	PILL SPLITTING INSTRUCTION						339	HALF TABLET DOSING REQUIRED
131	PILL SPLITTING INSTRUCTION						349	VOLUNTARY HALF TABLET INCENTIVE PROGRAM
131	PILL SPLITTING INSTRUCTION						361	TABLET MAY BE SPLIT TO REDUCE COSTS
132	INJECTABLE INTRUCTIONS OR RESTRICTIONS			106	MUST ENROLL IN INJECTABLE PROGRAM
132	INJECTABLE INTRUCTIONS OR RESTRICTIONS			235	REIMBURSABLE ONLY WITH A PRESCRIPTION FOR AN INJECTABLE DRUG
132	INJECTABLE INTRUCTIONS OR RESTRICTIONS			298	NON-SELF ADMINISTERED INJECTABLE
132	INJECTABLE INTRUCTIONS OR RESTRICTIONS			320	INJECTABLE COPAY
132	INJECTABLE INTRUCTIONS OR RESTRICTIONS			344	BRING / INJECT AT DOCTORS OFFICE
133	ADDITIONAL COVERAGE/COPAY INFORMATION			147	GENERIC NOT MANDATORY
133	ADDITIONAL COVERAGE/COPAY INFORMATION			062	GENERIC IS PREFERRED DRUG IN CLASS
133	ADDITIONAL COVERAGE/COPAY INFORMATION			152	OTC IS COVERED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			153	OTC STRENGTH IS NOT COVERED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			207	OTC RECOMMENDED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			336	OTC SELECT CO-PAY IS HALF OF YOUR GENERIC CO-PAY
133	ADDITIONAL COVERAGE/COPAY INFORMATION			063	OTCS ARE FIRST LINE OF THERAPY
133	ADDITIONAL COVERAGE/COPAY INFORMATION			135	OTC COVERAGE NOT INDICATED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			277	ONE COPAY PER 3 CYCLES
133	ADDITIONAL COVERAGE/COPAY INFORMATION			053	1 CYCLE/ COPAY, UP TO 3 CYCLES/TRANS (OC'S ONLY)
133	ADDITIONAL COVERAGE/COPAY INFORMATION			221	3 COPAYS
133	ADDITIONAL COVERAGE/COPAY INFORMATION			318	2 COPAYS
133	ADDITIONAL COVERAGE/COPAY INFORMATION			239	COVERAGE AT TIER 2 FOR 3 MONTHS EVERY CALENDAR YEAR
133	ADDITIONAL COVERAGE/COPAY INFORMATION			291	100% COPAY PHARMACY BENEFIT
133	ADDITIONAL COVERAGE/COPAY INFORMATION			292	100% COPAY MEDICAL BENEFIT
133	ADDITIONAL COVERAGE/COPAY INFORMATION			299	LOWER COST ALTERNATIVE IS AVAILABLE
133	ADDITIONAL COVERAGE/COPAY INFORMATION			303	HIGHER COPAY MAY APPLY IF GENERIC IS NOT USED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			355	ADDITIONAL COSTS MAY APPLY IF GENERIC IS NOT USED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			324	DOES NOT COUNT TOWARDS TOTAL OUT-OF-POCKET EXPENDITURE
133	ADDITIONAL COVERAGE/COPAY INFORMATION			329	PRESCRIPTION COST NOT APPLIED TO PRESCRIPTION CAP
133	ADDITIONAL COVERAGE/COPAY INFORMATION			325	COVERED UNDER MEDICARE PART D
133	ADDITIONAL COVERAGE/COPAY INFORMATION			331	COVERED UNDER MEDICARE PART B
133	ADDITIONAL COVERAGE/COPAY INFORMATION			332	CO-PAY MAY APPLY
133	ADDITIONAL COVERAGE/COPAY INFORMATION			304	COPAY IS 20% OF TOTAL COST
133	ADDITIONAL COVERAGE/COPAY INFORMATION			341	CO-PAY MAY BE WAIVED FOR TRIAL OPPORTUNITY
133	ADDITIONAL COVERAGE/COPAY INFORMATION			138	CO-PAYMENT DEPENDENT ON TIER STRUCTURE
133	ADDITIONAL COVERAGE/COPAY INFORMATION			151	CONTRACTED DRUG
133	ADDITIONAL COVERAGE/COPAY INFORMATION			064	COST DEPENDENT ON DIAGNOSIS
133	ADDITIONAL COVERAGE/COPAY INFORMATION			007	AVAIL AT NO COST TO PATIENTS WITH RESISTANT TB
133	ADDITIONAL COVERAGE/COPAY INFORMATION			067	SHIELD 65 NOT COVERED
133	ADDITIONAL COVERAGE/COPAY INFORMATION			073	NOT COVERED FOR TRAVEL
;
run;


Proc Sort;
by Prod_Notes_Code;
run;
*/

/*data FFDir.formstatus;*/
/*	input form_status_code formulary_status $10. ;*/
/*datalines;*/
/*101	PREFER*/
/*102	APPROVE*/
/*103	PREF/RES*/
/*104	PR AUTH*/
/*105	RESTRICT*/
/*106	NON FRM*/
/*107	NO REIM*/
/*108	30DY RTL*/
/*109	RET PPQ*/
/*110	ARET PPQ*/
/*111	DISC UNK*/
/*112 PREF BRD*/
/*113 PREF GEN*/
/*114 NONP BRD*/
/*115 NONP GEN*/
/*116 NF REIM*/
/*117 NF NR*/
/*118 SPEC*/
/*119 SPEC PA*/
/*120 MED BENE*/
/*121 NL REIM*/
/*122 NOT LSTD*/
/*;*/
/*run;*/
/**/


/* create numeric tier var with tier =10 for missing */

%macro mergedata(indata, outdata, mapping, sortbyvar);
	 indata: input data set 
 outdata: output data set 
 mapping: mapping file to be merged with the input dataset 
 sortbyvar: variable by which input is sorted for merging 

data temp;
	set &indata.;
run;

proc sort data = temp;
	by &sortbyvar.;
run;

proc sort data = &mapping.;
	by &sortbyvar.;
run;

data temp;
	merge temp (in=a) &mapping.;
	by &sortbyvar.;
	if a;
run;

data &outdata.;
	set temp;
run;

%mend mergedata;

/* create dummies at LEVEL 1 (form_stren_level) and transpose */

%macro transposedata(indata,outdata);

data temp;
	set &indata.;

 /* Set Tier equal to that in data , if missing, set to 15 */

    tier_num = input(tier,3.);
	if tier_num = 97 then tier_num=15;
	if tier_num = 98 then tier_num=13;
	if tier_num = 99 then tier_num=14;
	if tier_num = . then tier_num = 15;
run;

proc sort data=temp;
	by 	Plan_number formulary_name 
		therapeutic_area_code prod_code form_stren_level_code ;
run;

data temp;
	set temp;
	array formcode{33} formcode101-formcode133; 
	array statuscode{22} statuscode101-statuscode122; 
	array tiercode{15} tiercode1-tiercode15; 

	retain  formcode101-formcode130;
	retain statuscode101-statuscode122;
	retain tiercode1-tiercode15; 
	by 
		Plan_number formulary_name 
		therapeutic_area_code prod_code form_stren_level_code ;
	if first.form_stren_level_code
	then do i=1 to 33;
		formcode(i)=0;
	end; 
	if first.form_stren_level_code
	then do j=1 to 22;
		statuscode(j)=0;
	end; 
	if first.form_stren_level_code 
	then do k=1 to 15;
		tiercode(k)=0;
	end; 

	if code>0
	then formcode(code-100)=1;
	if form_Status_Code>0
	then statuscode(form_Status_Code-100)=1;
	if tier_num>0
	then tiercode(tier_num)=1;

	if last.form_stren_level_code then output;
	drop i j k;
run;

data &outdata.;
	set temp;
run;

%mend transposedata;


/* merges prodnotes and formstatus mapping files with input dataset */

%macro mergemapfiles(indata, outdata);

data temp1;
set &indata.;
run;

%mergedata(temp1, temp2, FFDir.prodnotes,Prod_Notes_Code);

/* If Formulary_Status is missing then try to use Notes field to populate Formulary Status */

Data Temp2;
set temp2;
if Formulary_status='DISC UNK' and Code=117 then do;statuscode101=1;Formulary_status='PREFER'; end;
if Formulary_status='DISC UNK' and Code=118 then do;statuscode106=1;Formulary_status='NON FRM';end;
if Formulary_status='DISC UNK' and Code=119 then do;statuscode107=1;Formulary_status='NO REIM';end;
run;
 
%mergedata(temp2, &outdata, FFDir.formstatus,formulary_status);

%mend mergemapfiles;


/* check for multiple Product codes (all prior categories same) */
/* create "outdata" dataset and export to Excel */

%macro multiple_prod_code(indata,outdata, myext,name);
data temp;
	set &indata;
	by 	Plan_number formulary_name 
		therapeutic_area_code prod_code form_stren_level_code ;
   	if first.prod_code and last.prod_code 
	then delete; 
run;

PROC EXPORT DATA= temp
            OUTFILE= "&myext\%str(&name).xls" 
            DBMS=EXCEL2000 REPLACE;
run;	

data &outdata;
	set temp;
run;

%mend multiple_prod_code;


/* roll up LEVEL 1 (therapeutic area) */

%macro rollup1(indata, outdata);

data temp;
	set &indata.;
run;

proc sort data = temp;
	by 	Plan_number formulary_name 
		therapeutic_area_code prod_code;
run;

data temp;
	set temp;
	by 	Plan_number formulary_name 
		therapeutic_area_code prod_code;

	array roll_formcode{33} roll_formcode101-roll_formcode133; 
	array roll_statuscode{22} roll_statuscode101-roll_statuscode122; 
	array roll_tiercode{15} roll_tiercode1-roll_tiercode15; 
	
	array formcode{33} formcode101-formcode133; 
	array statuscode{22} statuscode101-statuscode122; 
	array tiercode{15} tiercode1-tiercode15; 

	retain roll_formcode101-roll_formcode133; 
	retain roll_statuscode101-roll_statuscode122; 
	retain roll_tiercode1-roll_tiercode15; 

	multiple_form_indicator=1;
	if first.prod_code and last.prod_code then multiple_form_indicator=0; 
	if first.prod_code
	then do;
		do i = 1 to 33;
			roll_formcode[i] = formcode[i];
		end;
		
		do j = 1 to 22;
			roll_statuscode[j] = statuscode[j];
		end;

		do k = 1 to 15;
			roll_tiercode[k] = tiercode[k];
		end;
	end;

	do i = 1 to 33;
		if roll_formcode[i] ne 1 then roll_formcode[i] = formcode[i];
	end;

	do i = 1 to 22;
		if roll_statuscode[i] ne 1 then roll_statuscode[i] = statuscode[i];
	end;

	do i = 1 to 15;
		if roll_tiercode[i] ne 1 then roll_tiercode[i] = tiercode[i];
	end;

	if last.prod_code then output;

	drop	formcode101-formcode133 
			statuscode101-statuscode122 
			tiercode1-tiercode15
			i j k;
run;

data &outdata.;
	set temp;
run;

%mend rollup1;


%macro multiple_therapy_areas(indata,outdata, myext,name);
Data temp;
set &indata;
run;

Proc sort;
by Plan_number formulary_name 
		 prod_code therapeutic_area_code;
run;

data temp;
	set temp;
	by 	Plan_number formulary_name 
		 prod_code therapeutic_area_code;
   	if first.prod_code and last.prod_code 
	then delete; 
run;

PROC EXPORT DATA= temp
            OUTFILE= "&myext\%str(&name).xls" 
            DBMS=EXCEL2000 REPLACE;
run;	

data &outdata;
	set temp;
run;
%mend multiple_therapy_areas;


%macro rollup2(indata, outdata);

data temp;
	set &indata.;
run;

proc sort data = temp;
	by 	Plan_number formulary_name 
		prod_code;
run;

data temp;
	set temp;
	by 	Plan_number formulary_name 
		prod_code;

	array roll_formcode{33} roll2_formcode101-roll2_formcode133; 
	array roll_statuscode{22} roll2_statuscode101-roll2_statuscode122; 
	array roll_tiercode{15} roll2_tiercode1-roll2_tiercode15; 
	
	array formcode{33}  roll_formcode101-roll_formcode133; 
	array statuscode{22} roll_statuscode101-roll_statuscode122; 
	array tiercode{15} roll_tiercode1-roll_tiercode15; 

	retain roll2_formcode101-roll2_formcode133; 
	retain roll2_statuscode101-roll2_statuscode122; 
	retain roll2_tiercode1-roll2_tiercode15; 

	multiple_therapy_indicator=1;
	if first.prod_code and last.prod_code then multiple_therapy_indicator=0; 
	if first.prod_code
	then do;
		do i = 1 to 33;
			roll_formcode[i] = formcode[i];
		end;
		
		do j = 1 to 22;
			roll_statuscode[j] = statuscode[j];
		end;

		do k = 1 to 15;
			roll_tiercode[k] = tiercode[k];
		end;
	end;

	do i = 1 to 33;
		if roll_formcode[i] ne 1 then roll_formcode[i] = formcode[i];
	end;

	do i = 1 to 22;
		if roll_statuscode[i] ne 1 then roll_statuscode[i] = statuscode[i];
	end;

	do i = 1 to 15;
		if roll_tiercode[i] ne 1 then roll_tiercode[i] = tiercode[i];
	end;

	if last.prod_code then output;

	drop	roll_formcode101-roll_formcode133
			roll_statuscode101-roll_statuscode111 
			roll_tiercode1-roll_tiercode15
			i j k;
run;

data &outdata.;
	set temp;
run;

%mend rollup2;


%macro FF_Analysis(Datadirname, Dataname,Directory);
/* Datadirname: directory with input datafile and output analysis*/
/* Dataname: input file name and extension for all output */
/* Directory: output directory explicitly set for export outputs */
/* Merge with mapping files */

%mergemapfiles(%str(&Datadirname).&Dataname, %str(&Datadirname).mappeddata_&Dataname);

/* Transpose Data */

%transposedata(%str(&Datadirname).mappeddata_&Dataname,%str(&Datadirname).TherapyFormStrength_&Dataname);

/* Output Products with multiple Product Codes --> SAS And Excel */

%multiple_prod_code(%str(&Datadirname).TherapyFormStrength_&Dataname
,%str(&Datadirname).multiple_prod_codes_&Dataname, 
&Directory,multiple_prod_codes_&Dataname);

/* roll up level 1 (therapeutic area level) */
%rollup1(%str(&Datadirname).TherapyFormStrength_&Dataname,
%str(&Datadirname).Therapyprod_&Dataname);

%multiple_therapy_areas(%str(&Datadirname).Therapyprod_&Dataname,
%str(&Datadirname).multiple_therapy_areas_&Dataname, 
&Directory,multiple_therapy_Areas_&Dataname);

%rollup2(%str(&Datadirname).Therapyprod_&Dataname,%str(&Datadirname).Prod_&Dataname);

/* Fill in Tier using Formulary Status Codes */

Data %str(&Datadirname).Prod_&Dataname;
set %str(&Datadirname).Prod_&Dataname;

/* Step 1: USe Tiercodes to fill in missing tiers if possible (Note: Codes as lowest tier available */

Array A(15) roll2_tiercode1-roll2_tiercode15;
Do i=1 to 15;
if tier_num=15 and A(i)=1 then tier_num=i;
end;

/* Step 2: USe Formulary Status Codes to fill in missing tiers if possible */

/*113 PREF GEN*/

if tier_num=15 and roll2_statuscode113=1 then  tier_num=1;


/*101	PREFER*/
/*102	APPROVE*/
/*103	PREF/RES*/
/*112 PREF BRD*/
/*115 NONP GEN*/

if tier_num=15 and roll2_statuscode101=1 then  tier_num=2;
if tier_num=15 and roll2_statuscode102=1 then  tier_num=2;
if tier_num=15 and roll2_statuscode103=1 then  tier_num=2;
if tier_num=15 and roll2_statuscode112=1 then  tier_num=2;
if tier_num=15 and roll2_statuscode115=1 then  tier_num=2;

/*104	PR AUTH*/
/*105	RESTRICT*/
/*106	NON FRM*/
/*114 NONP BRD*/
/*116 NF REIM*/
/*121 NL REIM*/

if tier_num=15 and roll2_statuscode106=1 then  tier_num=3;
if tier_num=15 and roll2_statuscode105=1 then  tier_num=3;
if tier_num=15 and roll2_statuscode104=1 then  tier_num=3;
if tier_num=15 and roll2_statuscode114=1 then  tier_num=3;
if tier_num=15 and roll2_statuscode116=1 then  tier_num=3;
if tier_num=15 and roll2_statuscode121=1 then  tier_num=3;

/* No Reimbursement */

/*107	NO REIM*/
/*117 NF NR*/

if tier_num=15 and roll2_statuscode107=1 then  tier_num=11;
if tier_num=15 and roll2_statuscode117=1 then  tier_num=11;

/* Step 3: (To be added): Use prod_notes codes to fill in Medical Benefit */

/*if tier_num=15 and roll2_formcode127=1 then  tier_num=12;*/


run;

%mend FF_Analysis;


%macro Fill_Tiers(indata,outdata);
Data &outdata;
set &indata;
/* Step 1: USe Tiercodes to fill in missing tiers if possible (Note: Codes as lowest tier available */

Array A(10) roll2_tiercode1-roll2_tiercode10;
Do i=1 to 10;
if tier_num=10 and A(i)=1 then tier_num=i;
end;

/* Step 2: USe Formulary Status Codes to fill in missing tiers if possible */

if tier_num=10 and roll2_statuscode101=1 then  tier_num=2;
if tier_num=10 and roll2_statuscode102=1 then  tier_num=2;
if tier_num=10 and roll2_statuscode103=1 then  tier_num=2;
if tier_num=10 and roll2_statuscode106=1 then  tier_num=3;
if tier_num=10 and roll2_statuscode105=1 then  tier_num=3;
if tier_num=10 and roll2_statuscode104=1 then  tier_num=3;

/* No Reimbursement */

if tier_num=10 and roll2_statuscode107=1 then  tier_num=11;


/* Step 3: (To be added): Use prod_notes codes to fill in Medical Benefit */

if tier_num=10 and roll2_formcode127=1 then  tier_num=12;
run;

%mend Fill_Tiers;


%macro Primary_Formulary(indata,outdata);

Data &outdata;
set &indata;

%mend Primary_Formulary;
